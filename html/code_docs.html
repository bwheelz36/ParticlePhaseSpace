<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Code Documentation &mdash; Particle Phase Space  documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=19f00094" />

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="_static/jquery.js?v=5d32c60e"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="_static/documentation_options.js?v=5929fcd5"></script>
        <script src="_static/doctools.js?v=9a2dae69"></script>
        <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="Limitations" href="limitations.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            Particle Phase Space
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="examples.html">Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="phase_space_format.html">Phase Space Format</a></li>
<li class="toctree-l1"><a class="reference internal" href="supported_particles.html">Supported particles</a></li>
<li class="toctree-l1"><a class="reference internal" href="limitations.html">Limitations</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Code Documentation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#module-ParticlePhaseSpace.DataLoaders">Data Loaders</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#ParticlePhaseSpace.DataLoaders.Load_IAEA"><code class="docutils literal notranslate"><span class="pre">Load_IAEA</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#ParticlePhaseSpace.DataLoaders.Load_PandasData"><code class="docutils literal notranslate"><span class="pre">Load_PandasData</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#ParticlePhaseSpace.DataLoaders.Load_TibarayData"><code class="docutils literal notranslate"><span class="pre">Load_TibarayData</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#ParticlePhaseSpace.DataLoaders.Load_TopasData"><code class="docutils literal notranslate"><span class="pre">Load_TopasData</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#ParticlePhaseSpace.DataLoaders.Load_p2sat_txt"><code class="docutils literal notranslate"><span class="pre">Load_p2sat_txt</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#phasespace">PhaseSpace</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#ParticlePhaseSpace._ParticlePhaseSpace.PhaseSpace"><code class="docutils literal notranslate"><span class="pre">PhaseSpace</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#ParticlePhaseSpace._ParticlePhaseSpace.PhaseSpace.assess_density_versus_r"><code class="docutils literal notranslate"><span class="pre">PhaseSpace.assess_density_versus_r()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#ParticlePhaseSpace._ParticlePhaseSpace.PhaseSpace.calculate_twiss_parameters"><code class="docutils literal notranslate"><span class="pre">PhaseSpace.calculate_twiss_parameters()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#ParticlePhaseSpace._ParticlePhaseSpace.PhaseSpace.filter_by_boolean_index"><code class="docutils literal notranslate"><span class="pre">PhaseSpace.filter_by_boolean_index()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#ParticlePhaseSpace._ParticlePhaseSpace.PhaseSpace.filter_by_time"><code class="docutils literal notranslate"><span class="pre">PhaseSpace.filter_by_time()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#ParticlePhaseSpace._ParticlePhaseSpace.PhaseSpace.get_downsampled_phase_space"><code class="docutils literal notranslate"><span class="pre">PhaseSpace.get_downsampled_phase_space()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#ParticlePhaseSpace._ParticlePhaseSpace.PhaseSpace.merge"><code class="docutils literal notranslate"><span class="pre">PhaseSpace.merge()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#ParticlePhaseSpace._ParticlePhaseSpace.PhaseSpace.print_energy_stats"><code class="docutils literal notranslate"><span class="pre">PhaseSpace.print_energy_stats()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#ParticlePhaseSpace._ParticlePhaseSpace.PhaseSpace.print_twiss_parameters"><code class="docutils literal notranslate"><span class="pre">PhaseSpace.print_twiss_parameters()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#ParticlePhaseSpace._ParticlePhaseSpace.PhaseSpace.resample_via_gaussian_kde"><code class="docutils literal notranslate"><span class="pre">PhaseSpace.resample_via_gaussian_kde()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#ParticlePhaseSpace._ParticlePhaseSpace.PhaseSpace.reset_phase_space"><code class="docutils literal notranslate"><span class="pre">PhaseSpace.reset_phase_space()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#ParticlePhaseSpace._ParticlePhaseSpace.PhaseSpace.set_units"><code class="docutils literal notranslate"><span class="pre">PhaseSpace.set_units()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#ParticlePhaseSpace._ParticlePhaseSpace.PhaseSpace.sort"><code class="docutils literal notranslate"><span class="pre">PhaseSpace.sort()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#phasespace-plot">PhaseSpace.plot</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#ParticlePhaseSpace._ParticlePhaseSpace._Plots"><code class="docutils literal notranslate"><span class="pre">_Plots</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#ParticlePhaseSpace._ParticlePhaseSpace._Plots.energy_hist_1D"><code class="docutils literal notranslate"><span class="pre">_Plots.energy_hist_1D()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#ParticlePhaseSpace._ParticlePhaseSpace._Plots.momentum_hist_1D"><code class="docutils literal notranslate"><span class="pre">_Plots.momentum_hist_1D()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#ParticlePhaseSpace._ParticlePhaseSpace._Plots.n_particles_v_time"><code class="docutils literal notranslate"><span class="pre">_Plots.n_particles_v_time()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#ParticlePhaseSpace._ParticlePhaseSpace._Plots.particle_positions_hist_2D"><code class="docutils literal notranslate"><span class="pre">_Plots.particle_positions_hist_2D()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#ParticlePhaseSpace._ParticlePhaseSpace._Plots.particle_positions_scatter_2D"><code class="docutils literal notranslate"><span class="pre">_Plots.particle_positions_scatter_2D()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#ParticlePhaseSpace._ParticlePhaseSpace._Plots.position_hist_1D"><code class="docutils literal notranslate"><span class="pre">_Plots.position_hist_1D()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#ParticlePhaseSpace._ParticlePhaseSpace._Plots.transverse_trace_space_hist_2D"><code class="docutils literal notranslate"><span class="pre">_Plots.transverse_trace_space_hist_2D()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#ParticlePhaseSpace._ParticlePhaseSpace._Plots.transverse_trace_space_scatter_2D"><code class="docutils literal notranslate"><span class="pre">_Plots.transverse_trace_space_scatter_2D()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#phasespace-fill">PhaseSpace.fill</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#ParticlePhaseSpace._ParticlePhaseSpace._Fill_Methods"><code class="docutils literal notranslate"><span class="pre">_Fill_Methods</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#ParticlePhaseSpace._ParticlePhaseSpace._Fill_Methods.beta_and_gamma"><code class="docutils literal notranslate"><span class="pre">_Fill_Methods.beta_and_gamma()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#ParticlePhaseSpace._ParticlePhaseSpace._Fill_Methods.direction_cosines"><code class="docutils literal notranslate"><span class="pre">_Fill_Methods.direction_cosines()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#ParticlePhaseSpace._ParticlePhaseSpace._Fill_Methods.kinetic_E"><code class="docutils literal notranslate"><span class="pre">_Fill_Methods.kinetic_E()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#ParticlePhaseSpace._ParticlePhaseSpace._Fill_Methods.relativistic_mass"><code class="docutils literal notranslate"><span class="pre">_Fill_Methods.relativistic_mass()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#ParticlePhaseSpace._ParticlePhaseSpace._Fill_Methods.rest_mass"><code class="docutils literal notranslate"><span class="pre">_Fill_Methods.rest_mass()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#ParticlePhaseSpace._ParticlePhaseSpace._Fill_Methods.velocity"><code class="docutils literal notranslate"><span class="pre">_Fill_Methods.velocity()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#phasespace-transform">PhaseSpace.transform</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-ParticlePhaseSpace.DataExporters">Data Exporters</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#ParticlePhaseSpace.DataExporters.CSV_Exporter"><code class="docutils literal notranslate"><span class="pre">CSV_Exporter</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#ParticlePhaseSpace.DataExporters.Topas_Exporter"><code class="docutils literal notranslate"><span class="pre">Topas_Exporter</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Particle Phase Space</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Code Documentation</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/code_docs.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="code-documentation">
<h1>Code Documentation<a class="headerlink" href="#code-documentation" title="Link to this heading"></a></h1>
<p>This page shows the documentation generated by sphinx automatically scanning our source code</p>
<section id="module-ParticlePhaseSpace.DataLoaders">
<span id="data-loaders"></span><h2>Data Loaders<a class="headerlink" href="#module-ParticlePhaseSpace.DataLoaders" title="Link to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="ParticlePhaseSpace.DataLoaders.Load_IAEA">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">ParticlePhaseSpace.DataLoaders.</span></span><span class="sig-name descname"><span class="pre">Load_IAEA</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data_schema:</span> <span class="pre">~numpy.dtype</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">constants:</span> <span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_data:</span> <span class="pre">(&lt;class</span> <span class="pre">'str'&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">&lt;class</span> <span class="pre">'pathlib.Path'&gt;)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_records:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">offset=0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">**kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ParticlePhaseSpace.DataLoaders.Load_IAEA" title="Link to this definition"></a></dt>
<dd><p>this loads a binary varian IAEA sent through the topas forums.
Because this format is so arbitrary, uses are required to pass a data_schema variable indicating the order
and types of the data in the phase space, because there is no general way for us to figure this out.
Please see <a class="reference external" href="https://bwheelz36.github.io/ParticlePhaseSpace/IAEA.html">here</a> for examples of how to
use this data loader.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data_schema</strong> (<em>np.dtype</em>) – the types and order of data, specified as an np.dtype</p></li>
<li><p><strong>constants</strong> – any constants in the phase space</p></li>
<li><p><strong>input_data</strong> – path to the a .phsp or .IAEAphsp file</p></li>
<li><p><strong>n_records</strong> – specify how many rows of data to read in. By default, will read all rows.</p></li>
<li><p><strong>offset</strong> – which row to start at. defaults to 0 (first row). Can be used in conjunction with n_records
to read a large file in a series of small chunks</p></li>
</ul>
</dd>
</dl>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">ParticlePhaseSpace</span> <span class="kn">import</span> <span class="n">PhaseSpace</span><span class="p">,</span> <span class="n">DataLoaders</span>
<span class="kn">from</span> <span class="nn">pathlib</span> <span class="kn">import</span> <span class="n">Path</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="n">file_name</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;/home/brendan/Downloads/Varian_TrueBeam6MV_01.phsp&#39;</span><span class="p">)</span>
<span class="n">data_schema</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dtype</span><span class="p">([</span>
                       <span class="p">(</span><span class="s1">&#39;particle type&#39;</span><span class="p">,</span> <span class="s1">&#39;i1&#39;</span><span class="p">),</span>
                       <span class="p">(</span><span class="s1">&#39;Ek&#39;</span><span class="p">,</span> <span class="s1">&#39;f4&#39;</span><span class="p">),</span>
                       <span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="s1">&#39;f4&#39;</span><span class="p">),</span>
                       <span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="s1">&#39;f4&#39;</span><span class="p">),</span>
                       <span class="p">(</span><span class="s1">&#39;z&#39;</span><span class="p">,</span> <span class="s1">&#39;f4&#39;</span><span class="p">),</span>
                       <span class="p">(</span><span class="s1">&#39;Cosine X&#39;</span><span class="p">,</span> <span class="s1">&#39;f4&#39;</span><span class="p">),</span>
                       <span class="p">(</span><span class="s1">&#39;Cosine Y&#39;</span><span class="p">,</span> <span class="s1">&#39;f4&#39;</span><span class="p">)</span>
                       <span class="p">])</span>
<span class="n">constants</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;weight&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">int8</span><span class="p">(</span><span class="mi">1</span><span class="p">)}</span>
<span class="n">ps_data</span> <span class="o">=</span> <span class="n">DataLoaders</span><span class="o">.</span><span class="n">Load_IAEA</span><span class="p">(</span><span class="n">data_schema</span><span class="o">=</span><span class="n">data_schema</span><span class="p">,</span> <span class="n">constants</span><span class="o">=</span><span class="n">constants</span><span class="p">,</span> <span class="n">input_data</span><span class="o">=</span><span class="n">file_name</span><span class="p">,</span> <span class="n">n_records</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="mf">1e5</span><span class="p">))</span>
<span class="n">PS</span> <span class="o">=</span> <span class="n">PhaseSpace</span><span class="p">(</span><span class="n">ps_data</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="ParticlePhaseSpace.DataLoaders.Load_PandasData">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">ParticlePhaseSpace.DataLoaders.</span></span><span class="sig-name descname"><span class="pre">Load_PandasData</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_data:</span> <span class="pre">(&lt;class</span> <span class="pre">'str'&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">&lt;class</span> <span class="pre">'pathlib.Path'&gt;)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">particle_type:</span> <span class="pre">(&lt;class</span> <span class="pre">'str'&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">None)</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">units:</span> <span class="pre">~ParticlePhaseSpace.__unit_config__.UnitSet</span> <span class="pre">=</span> <span class="pre">&lt;ParticlePhaseSpace.__unit_config__.UnitSet</span> <span class="pre">object&gt;</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ParticlePhaseSpace.DataLoaders.Load_PandasData" title="Link to this definition"></a></dt>
<dd><p>loads in pandas data of the format. This is used internally by ParticlePhaseSpace, and can also be used
externally in cases where it is not desired to write a dedicated new data loader:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">ParticlePhaseSpace</span> <span class="kn">import</span> <span class="n">DataLoaders</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="n">demo_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
    <span class="p">{</span><span class="s1">&#39;x [mm]&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
     <span class="s1">&#39;y [mm]&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
     <span class="s1">&#39;z [mm]&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
     <span class="s1">&#39;px [MeV/c]&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
     <span class="s1">&#39;py [MeV/c]&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
     <span class="s1">&#39;pz [MeV/c]&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
     <span class="s1">&#39;particle type [pdg_code]&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">11</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">11</span><span class="p">],</span>
     <span class="s1">&#39;weight&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
     <span class="s1">&#39;particle id&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
     <span class="s1">&#39;time [ps]&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]})</span>

<span class="n">data</span> <span class="o">=</span> <span class="n">DataLoaders</span><span class="o">.</span><span class="n">Load_PandasData</span><span class="p">(</span><span class="n">demo_data</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="ParticlePhaseSpace.DataLoaders.Load_TibarayData">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">ParticlePhaseSpace.DataLoaders.</span></span><span class="sig-name descname"><span class="pre">Load_TibarayData</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_data:</span> <span class="pre">(&lt;class</span> <span class="pre">'str'&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">&lt;class</span> <span class="pre">'pathlib.Path'&gt;)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">particle_type:</span> <span class="pre">(&lt;class</span> <span class="pre">'str'&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">None)</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">units:</span> <span class="pre">~ParticlePhaseSpace.__unit_config__.UnitSet</span> <span class="pre">=</span> <span class="pre">&lt;ParticlePhaseSpace.__unit_config__.UnitSet</span> <span class="pre">object&gt;</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ParticlePhaseSpace.DataLoaders.Load_TibarayData" title="Link to this definition"></a></dt>
<dd><p>Load ASCII data from tibaray of format
<cite>x y z rxy Bx By Bz G t m q nmacro rmacro ID</cite>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">data_loc</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;../tests/test_data/tibaray_test.dat&#39;</span><span class="p">)</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">DataLoaders</span><span class="o">.</span><span class="n">Load_TibarayData</span><span class="p">(</span><span class="n">data_loc</span><span class="p">,</span> <span class="n">particle_type</span><span class="o">=</span><span class="mi">11</span><span class="p">)</span>
<span class="n">PS</span> <span class="o">=</span> <span class="n">PhaseSpace</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="ParticlePhaseSpace.DataLoaders.Load_TopasData">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">ParticlePhaseSpace.DataLoaders.</span></span><span class="sig-name descname"><span class="pre">Load_TopasData</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_data:</span> <span class="pre">(&lt;class</span> <span class="pre">'str'&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">&lt;class</span> <span class="pre">'pathlib.Path'&gt;)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">particle_type:</span> <span class="pre">(&lt;class</span> <span class="pre">'str'&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">None)</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">units:</span> <span class="pre">~ParticlePhaseSpace.__unit_config__.UnitSet</span> <span class="pre">=</span> <span class="pre">&lt;ParticlePhaseSpace.__unit_config__.UnitSet</span> <span class="pre">object&gt;</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ParticlePhaseSpace.DataLoaders.Load_TopasData" title="Link to this definition"></a></dt>
<dd><p>DataLoader for <a class="reference external" href="https://topas.readthedocs.io/en/latest/">Topas</a> data.
This data loader will read in both ascii and binary topas phase space (phsp) files.
At present, we do not handle time or particle-id fields which may or may not be present in topas data.
Behind the scenes, it relies on <a class="reference external" href="https://github.com/davidchall/topas2numpy">topas2numpy</a>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">ParticlePhaseSpace</span> <span class="kn">import</span> <span class="n">DataLoaders</span>
<span class="kn">from</span> <span class="nn">ParticlePhaseSpace</span> <span class="kn">import</span> <span class="n">PhaseSpace</span>
<span class="kn">from</span> <span class="nn">pathlib</span> <span class="kn">import</span> <span class="n">Path</span>

<span class="n">data_loc</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;../tests/test_data/coll_PhaseSpace_xAng_0.00_yAng_0.00_angular_error_0.0.phsp&#39;</span><span class="p">)</span>

<span class="n">data</span> <span class="o">=</span> <span class="n">DataLoaders</span><span class="o">.</span><span class="n">Load_TopasData</span><span class="p">(</span><span class="n">data_loc</span><span class="p">)</span>
<span class="n">PS</span> <span class="o">=</span> <span class="n">PhaseSpace</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="ParticlePhaseSpace.DataLoaders.Load_p2sat_txt">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">ParticlePhaseSpace.DataLoaders.</span></span><span class="sig-name descname"><span class="pre">Load_p2sat_txt</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_data:</span> <span class="pre">(&lt;class</span> <span class="pre">'str'&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">&lt;class</span> <span class="pre">'pathlib.Path'&gt;)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">particle_type:</span> <span class="pre">(&lt;class</span> <span class="pre">'str'&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">None)</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">units:</span> <span class="pre">~ParticlePhaseSpace.__unit_config__.UnitSet</span> <span class="pre">=</span> <span class="pre">&lt;ParticlePhaseSpace.__unit_config__.UnitSet</span> <span class="pre">object&gt;</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ParticlePhaseSpace.DataLoaders.Load_p2sat_txt" title="Link to this definition"></a></dt>
<dd><p>Adapted from the <a class="reference external" href="https://github.com/lesnat/p2sat/blob/master/p2sat/datasets/_LoadPhaseSpace.py">p2sat</a>
‘txt’ loader; loads csv data of format
<cite># weight          x (um)          y (um)          z (um)          px (MeV/c)      py (MeV/c)      pz (MeV/c)      t (fs)</cite>
Note that we use a hard coded seperator value “,”.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">available_units</span> <span class="o">=</span> <span class="n">ParticlePhaseSpaceUnits</span><span class="p">()</span>
<span class="n">data_url</span> <span class="o">=</span> <span class="s1">&#39;https://raw.githubusercontent.com/lesnat/p2sat/master/examples/ExamplePhaseSpace.csv&#39;</span>
<span class="n">file_name</span> <span class="o">=</span> <span class="s1">&#39;p2sat_txt_test.csv&#39;</span>
<span class="n">request</span><span class="o">.</span><span class="n">urlretrieve</span><span class="p">(</span><span class="n">data_url</span><span class="p">,</span> <span class="n">file_name</span><span class="p">)</span>
<span class="c1"># read in</span>
<span class="n">ps_data</span> <span class="o">=</span> <span class="n">DataLoaders</span><span class="o">.</span><span class="n">Load_p2sat_txt</span><span class="p">(</span><span class="n">file_name</span><span class="p">,</span> <span class="n">particle_type</span><span class="o">=</span><span class="s1">&#39;electrons&#39;</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="n">available_units</span><span class="p">(</span><span class="s1">&#39;p2_sat_UHI&#39;</span><span class="p">))</span>
<span class="n">PS</span> <span class="o">=</span> <span class="n">PhaseSpace</span><span class="p">(</span><span class="n">ps_data</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="phasespace">
<h2>PhaseSpace<a class="headerlink" href="#phasespace" title="Link to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="ParticlePhaseSpace._ParticlePhaseSpace.PhaseSpace">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">ParticlePhaseSpace._ParticlePhaseSpace.</span></span><span class="sig-name descname"><span class="pre">PhaseSpace</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data_loader</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ParticlePhaseSpace._ParticlePhaseSpace.PhaseSpace" title="Link to this definition"></a></dt>
<dd><p>This class holds phase space data in  a pandas dataframe, and allowed users to utilise common libraries for
plotting and analysis. It accepts data from any <a class="reference external" href="https://bwheelz36.github.io/ParticlePhaseSpace/code_docs.html#module-ParticlePhaseSpace.DataLoaders">DataLoader</a>
Basic use is documented <a class="reference external" href="https://bwheelz36.github.io/ParticlePhaseSpace/basic_example.html">here</a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>data_loader</strong> (<em>_DataLoadersBase</em>) – an instance of ParticlePhaseSpace.DataLoaders._DataLoadersBase</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="ParticlePhaseSpace._ParticlePhaseSpace.PhaseSpace.assess_density_versus_r">
<span class="sig-name descname"><span class="pre">assess_density_versus_r</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Rvals</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">beam_direction</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'z'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ParticlePhaseSpace._ParticlePhaseSpace.PhaseSpace.assess_density_versus_r" title="Link to this definition"></a></dt>
<dd><p>Assess how many particles are in a given radius</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Rvals</strong> – list of rvals to assess in mm, e.g. np.linspace(0, 2, 21)</p></li>
<li><p><strong>verbose</strong> – prints data to screen if True</p></li>
<li><p><strong>beam_direction</strong> (<em>str</em><em>, </em><em>optional</em>) – main direction in which beam is travelling. ‘x’, ‘y’, or ‘z’ (default)</p></li>
</ul>
</dd>
<dt class="field-even">Return density_data<span class="colon">:</span></dt>
<dd class="field-even"><p>a dataframe containing the roi vals and the proportion of particles inside</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ParticlePhaseSpace._ParticlePhaseSpace.PhaseSpace.calculate_twiss_parameters">
<span class="sig-name descname"><span class="pre">calculate_twiss_parameters</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">beam_direction</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'z'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ParticlePhaseSpace._ParticlePhaseSpace.PhaseSpace.calculate_twiss_parameters" title="Link to this definition"></a></dt>
<dd><p>Calculate the RMS <a class="reference external" href="https://en.wikipedia.org/wiki/Courant%E2%80%93Snyder_parameters">twiss parameters</a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>beam_direction</strong> (<em>str</em><em>, </em><em>optional</em>) – main direction in which beam is travelling. ‘x’, ‘y’, or ‘z’ (default)</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ParticlePhaseSpace._ParticlePhaseSpace.PhaseSpace.filter_by_boolean_index">
<span class="sig-name descname"><span class="pre">filter_by_boolean_index</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">boolean_index</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">in_place</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">split</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ParticlePhaseSpace._ParticlePhaseSpace.PhaseSpace.filter_by_boolean_index" title="Link to this definition"></a></dt>
<dd><p>filter data by input boolean index, keeping ‘True’ and discarding ‘False’</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>boolean_index</strong> – an 1D array like structure of True and False values</p></li>
<li><p><strong>in_place</strong> – if True, existing object is modified; if False a new object is returned</p></li>
<li><p><strong>split</strong> – if True, will return two phase space objects: one where boolan_index=True and one where it equals
False</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ParticlePhaseSpace._ParticlePhaseSpace.PhaseSpace.filter_by_time">
<span class="sig-name descname"><span class="pre">filter_by_time</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_start</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t_finish</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">in_place</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ParticlePhaseSpace._ParticlePhaseSpace.PhaseSpace.filter_by_time" title="Link to this definition"></a></dt>
<dd><p>Generates a new PhaseSpace which only contains particles inside t_start and t_finish (inclusive).
t_start and t_finish should be specfied in ps.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>t_start</strong> (<em>float</em>) – particles with t&lt;t_start are removed.</p></li>
<li><p><strong>t_finish</strong> (<em>float</em>) – particleswith t&gt;t_finish are removed</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>new_instance: a new phase space object with data filtered by time</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ParticlePhaseSpace._ParticlePhaseSpace.PhaseSpace.get_downsampled_phase_space">
<span class="sig-name descname"><span class="pre">get_downsampled_phase_space</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">downsample_factor</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">10</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ParticlePhaseSpace._ParticlePhaseSpace.PhaseSpace.get_downsampled_phase_space" title="Link to this definition"></a></dt>
<dd><p>return a new phase space object which randomlt samples from the larger phase space.
the new phase space has size ‘original data/downsample_factor’. the data is shuffled
before being randomly sampled.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>downsample_factor</strong> (<em>int</em>) – the factor to downsample the phase space by</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ParticlePhaseSpace._ParticlePhaseSpace.PhaseSpace.merge">
<span class="sig-name descname"><span class="pre">merge</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">in_place</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ParticlePhaseSpace._ParticlePhaseSpace.PhaseSpace.merge" title="Link to this definition"></a></dt>
<dd><p>merges identical data points by combining their weights.
Typically, before performing a merge operation you will want to perform a ‘regrid’ operation.
The underlying algorithm was developed by Leo Esnault for
the <a class="reference external" href="https://github.com/lesnat/p2sat">p2sat</a> code.
Merged particles retain the particle ID from the first particle in the merged group.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>in_place</strong> – if True, self is operated on; if False, a new PhaseSpace is returned</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>new_PS if in_place is False.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ParticlePhaseSpace._ParticlePhaseSpace.PhaseSpace.print_energy_stats">
<span class="sig-name descname"><span class="pre">print_energy_stats</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ParticlePhaseSpace._ParticlePhaseSpace.PhaseSpace.print_energy_stats" title="Link to this definition"></a></dt>
<dd><p>Prints a summary of energy stats to the screen, which can optionally be saved to json</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>file_name</strong> (<em>Path</em><em>, </em><em>str</em><em>, </em><em>optional</em>) – if specified, the data is saved as json in file_name</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ParticlePhaseSpace._ParticlePhaseSpace.PhaseSpace.print_twiss_parameters">
<span class="sig-name descname"><span class="pre">print_twiss_parameters</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">beam_direction</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'z'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ParticlePhaseSpace._ParticlePhaseSpace.PhaseSpace.print_twiss_parameters" title="Link to this definition"></a></dt>
<dd><p>prints the twiss parameters if they exist
they are always printed to the screen.
if filename is specified, they are also saved to file as json</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>file_name</strong> (<em>str</em><em> or </em><em>Path</em><em>, </em><em>optional</em>) – optional filename to write twiss data to. should be absolute path to an existing directory</p></li>
<li><p><strong>beam_direction</strong> (<em>str</em><em>, </em><em>optional</em>) – the direction the beam is travelling in. “x”, “y”, or “z” (default)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ParticlePhaseSpace._ParticlePhaseSpace.PhaseSpace.resample_via_gaussian_kde">
<span class="sig-name descname"><span class="pre">resample_via_gaussian_kde</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_new_particles_factor:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">interpolate_weights:</span> <span class="pre">(&lt;class</span> <span class="pre">'bool'&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">None)</span> <span class="pre">=</span> <span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ParticlePhaseSpace._ParticlePhaseSpace.PhaseSpace.resample_via_gaussian_kde" title="Link to this definition"></a></dt>
<dd><p>Generate a new phase space based on the existing data, by fitting a gaussian kernel density
estimate to the 6-D space:
<cite>x y z px py pz</cite>
If <cite>interpolate_weights</cite> is set to True, we instead attempt to interpolate within a 7D space:
<cite>x y z px py pz weight</cite>
This method is fairly experimental and should be used with extreme caution!</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>n_new_particles_factor</strong> – the returned Phase space will have size len(self)*n_new_particles_factor.
In other words, when n_new_particles_factor=1, the new PhaseSpace will be the same size as the original.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>new_PS: a new PhaseSpace object</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ParticlePhaseSpace._ParticlePhaseSpace.PhaseSpace.reset_phase_space">
<span class="sig-name descname"><span class="pre">reset_phase_space</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#ParticlePhaseSpace._ParticlePhaseSpace.PhaseSpace.reset_phase_space" title="Link to this definition"></a></dt>
<dd><p>reduce self._ps_data to only the required columns
delete any other derived quantities such as twiss parameters
this can be called whenever you want to reduce the memory footprint</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ParticlePhaseSpace._ParticlePhaseSpace.PhaseSpace.set_units">
<span class="sig-name descname"><span class="pre">set_units</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">new_units</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">UnitSet</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ParticlePhaseSpace._ParticlePhaseSpace.PhaseSpace.set_units" title="Link to this definition"></a></dt>
<dd><p>converts ps_data to a new unit set.
This will also reset the phase space to just the required columns</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>new_units</strong> (<em>UnitSet</em>) – the new units to convert to</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ParticlePhaseSpace._ParticlePhaseSpace.PhaseSpace.sort">
<span class="sig-name descname"><span class="pre">sort</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">quantities_to_sort:</span> <span class="pre">(None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">&lt;class</span> <span class="pre">'list'&gt;)</span> <span class="pre">=</span> <span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ParticlePhaseSpace._ParticlePhaseSpace.PhaseSpace.sort" title="Link to this definition"></a></dt>
<dd><p>sort the data. Data will be sorted according quantities_to_sort, in order of quantity.
Operates in place. example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">PS</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">quantities_to_sort</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="n">PS</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">quantities_to_sort</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="s1">&#39;z&#39;</span><span class="p">,</span> <span class="s1">&#39;px&#39;</span><span class="p">])</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>quantities_to_sort</strong></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="phasespace-plot">
<h2>PhaseSpace.plot<a class="headerlink" href="#phasespace-plot" title="Link to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="ParticlePhaseSpace._ParticlePhaseSpace._Plots">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">ParticlePhaseSpace._ParticlePhaseSpace.</span></span><span class="sig-name descname"><span class="pre">_Plots</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">PS</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ParticlePhaseSpace._ParticlePhaseSpace._Plots" title="Link to this definition"></a></dt>
<dd><dl class="py method">
<dt class="sig sig-object py" id="ParticlePhaseSpace._ParticlePhaseSpace._Plots.energy_hist_1D">
<span class="sig-name descname"><span class="pre">energy_hist_1D</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_bins</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grid</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ParticlePhaseSpace._ParticlePhaseSpace._Plots.energy_hist_1D" title="Link to this definition"></a></dt>
<dd><p>generate a histogram plot of paritcle energies.
Each particle spcies present in the phase space is overlaid  on the same plot.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n_bins</strong> (<em>int</em><em>, </em><em>optional</em>) – number of bins in histogram</p></li>
<li><p><strong>grid</strong> (<em>bool</em><em>, </em><em>optional</em>) – turns grid on/off</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ParticlePhaseSpace._ParticlePhaseSpace._Plots.momentum_hist_1D">
<span class="sig-name descname"><span class="pre">momentum_hist_1D</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_bins</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grid</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ParticlePhaseSpace._ParticlePhaseSpace._Plots.momentum_hist_1D" title="Link to this definition"></a></dt>
<dd><p>plot a histogram of particle momentum in x, y, z.
a new histogram is generated for each particle species.
histograms are overlaid.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n_bins</strong> – number of bins in histogram</p></li>
<li><p><strong>alpha</strong> – controls transparency of each histogram.</p></li>
<li><p><strong>grid</strong> (<em>bool</em><em>, </em><em>optional</em>) – turns grid on/off</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ParticlePhaseSpace._ParticlePhaseSpace._Plots.n_particles_v_time">
<span class="sig-name descname"><span class="pre">n_particles_v_time</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_bins</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grid</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ParticlePhaseSpace._ParticlePhaseSpace._Plots.n_particles_v_time" title="Link to this definition"></a></dt>
<dd><p>basic plot of number of particles versus time; useful for quickly seperating out different bunches
of electrons such that you can apply the ‘filter_by_time’ method</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n_bins</strong> (<em>int</em>) – number of bins for histogram</p></li>
<li><p><strong>grid</strong> (<em>bool</em><em>, </em><em>optional</em>) – turns grid on/off</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ParticlePhaseSpace._ParticlePhaseSpace._Plots.particle_positions_hist_2D">
<span class="sig-name descname"><span class="pre">particle_positions_hist_2D</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">beam_direction</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'z'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">quantity</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'intensity'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grid</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log_scale</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bins</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalize</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xlim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ylim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vmin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vmax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ParticlePhaseSpace._ParticlePhaseSpace._Plots.particle_positions_hist_2D" title="Link to this definition"></a></dt>
<dd><p>plot a 2D histogram of data, either of accumulated number of particules or accumulated energy</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>beam_direction</strong> (<em>str</em><em>, </em><em>optional</em>) – the direction the beam is travelling in. “x”, “y”, or “z” (default)</p></li>
<li><p><strong>xlim</strong> (<em>list</em><em>, </em><em>optional</em>) – set the xlim for all plots, e.g. [-2,2]</p></li>
<li><p><strong>ylim</strong> (<em>list</em><em>, </em><em>optional</em>) – set the ylim for all plots, e.g. [-2,2]</p></li>
<li><p><strong>quantity</strong> (<em>str</em>) – quantity to accumulate; either ‘intensity’ or ‘energy</p></li>
<li><p><strong>grid</strong> (<em>bool</em><em>, </em><em>optional</em>) – turns grid on/off</p></li>
<li><p><strong>bins</strong> (<em>int</em><em>, </em><em>optional</em>) – number of bins in X/Y direction. n_pixels = bins ** 2</p></li>
<li><p><strong>vmin</strong> (<em>float</em><em>, </em><em>optional</em>) – minimum color range</p></li>
<li><p><strong>vmax</strong> (<em>float</em><em>, </em><em>optional</em>) – maximum color range</p></li>
<li><p><strong>log_scale</strong> (<em>bool</em><em>, </em><em>optional</em>) – if True, log scale is used</p></li>
<li><p><strong>normalize</strong> (<em>bool</em><em>, </em><em>optional</em>) – if True, data is normalized to 0-100 - otherwise raw values are used</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ParticlePhaseSpace._ParticlePhaseSpace._Plots.particle_positions_scatter_2D">
<span class="sig-name descname"><span class="pre">particle_positions_scatter_2D</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">beam_direction</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'z'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight_position_plot</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grid</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xlim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ylim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ParticlePhaseSpace._ParticlePhaseSpace._Plots.particle_positions_scatter_2D" title="Link to this definition"></a></dt>
<dd><p>produce a scatter plot of particle positions.
one plot is produced for each unique species.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>beam_direction</strong> (<em>str</em><em>, </em><em>optional</em>) – the direction the beam is travelling in. “x”, “y”, or “z” (default)</p></li>
<li><p><strong>weight_position_plot</strong> (<em>bool</em>) – if True, a gaussian kde is used to weight the particle
positions. This can produce very informative and useful plots, but also be very slow.
If it is slow, you could try downsampling the phase space first using get_downsampled_phase_space</p></li>
<li><p><strong>grid</strong> (<em>bool</em><em>, </em><em>optional</em>) – turns grid on/off</p></li>
<li><p><strong>xlim</strong> (<em>list</em><em> or </em><em>None</em><em>, </em><em>optional</em>) – set the xlim for all plots, e.g. [-2,2]</p></li>
<li><p><strong>ylim</strong> (<em>list</em><em> or </em><em>None</em><em>, </em><em>optional</em>) – set the ylim for all plots, e.g. [-2,2]</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ParticlePhaseSpace._ParticlePhaseSpace._Plots.position_hist_1D">
<span class="sig-name descname"><span class="pre">position_hist_1D</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_bins</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grid</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ParticlePhaseSpace._ParticlePhaseSpace._Plots.position_hist_1D" title="Link to this definition"></a></dt>
<dd><p>plot a histogram of particle positions in x, y, z.
a new histogram is generated for each particle species.
histograms are overlaid.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n_bins</strong> – number of bins in histogram</p></li>
<li><p><strong>alpha</strong> – controls transparency of each histogram.</p></li>
<li><p><strong>grid</strong> (<em>bool</em><em>, </em><em>optional</em>) – turns grid on/off</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ParticlePhaseSpace._ParticlePhaseSpace._Plots.transverse_trace_space_hist_2D">
<span class="sig-name descname"><span class="pre">transverse_trace_space_hist_2D</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">beam_direction</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'z'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_twiss_ellipse</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grid</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bins</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log_scale</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalize</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xlim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ylim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vmin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vmax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ParticlePhaseSpace._ParticlePhaseSpace._Plots.transverse_trace_space_hist_2D" title="Link to this definition"></a></dt>
<dd><p>plot the intensity of the beam in trace space</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>beam_direction</strong> (<em>str</em><em>, </em><em>optional</em>) – the direction the beam is travelling in. “x”, “y”, or “z” (default)</p></li>
<li><p><strong>xlim</strong> (<em>list</em><em>, </em><em>optional</em>) – set the xlim for all plots, e.g. [-2,2]</p></li>
<li><p><strong>ylim</strong> (<em>list</em><em>, </em><em>optional</em>) – set the ylim for all plots, e.g. [-2,2]</p></li>
<li><p><strong>plot_twiss_ellipse</strong> (<em>bool</em><em>, </em><em>optional</em>) – if True, RMS ellipse from twiss parameters is overlaid.</p></li>
<li><p><strong>grid</strong> (<em>bool</em><em>, </em><em>optional</em>) – turns grid on/off</p></li>
<li><p><strong>log_scale</strong> (<em>bool</em><em>, </em><em>optional</em>) – if True, log scale is used</p></li>
<li><p><strong>bins</strong> (<em>int</em><em>, </em><em>optional</em>) – number of bins in X/Y direction. n_pixels = bins ** 2</p></li>
<li><p><strong>vmin</strong> (<em>float</em><em>, </em><em>optional</em>) – minimum color range</p></li>
<li><p><strong>vmax</strong> (<em>float</em><em>, </em><em>optional</em>) – maximum color range</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ParticlePhaseSpace._ParticlePhaseSpace._Plots.transverse_trace_space_scatter_2D">
<span class="sig-name descname"><span class="pre">transverse_trace_space_scatter_2D</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">beam_direction</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'z'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_twiss_ellipse</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grid</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xlim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ylim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ParticlePhaseSpace._ParticlePhaseSpace._Plots.transverse_trace_space_scatter_2D" title="Link to this definition"></a></dt>
<dd><p>Generate a scatter plot of x versus x’=px/pz and y versus y’=py/pz (these definitions are for
beam_direction=’z’)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>beam_direction</strong> (<em>str</em><em>, </em><em>optional</em>) – main direction in which beam is travelling. ‘x’, ‘y’, or ‘z’ (default)</p></li>
<li><p><strong>plot_twiss_ellipse</strong> (<em>bool</em><em>, </em><em>optional</em>) – if True, will overlay the RMS twiss ellipse onto the trace space</p></li>
<li><p><strong>xlim</strong> (<em>list</em><em>, </em><em>optional</em>) – set xlim, e.g. [-2,2]</p></li>
<li><p><strong>ylim</strong> (<em>list</em><em>, </em><em>optional</em>) – set ylim, e.g. [-2,2]</p></li>
<li><p><strong>grid</strong> (<em>bool</em><em>, </em><em>optional</em>) – turns grid on/off</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="phasespace-fill">
<h2>PhaseSpace.fill<a class="headerlink" href="#phasespace-fill" title="Link to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="ParticlePhaseSpace._ParticlePhaseSpace._Fill_Methods">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">ParticlePhaseSpace._ParticlePhaseSpace.</span></span><span class="sig-name descname"><span class="pre">_Fill_Methods</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">PS</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ParticlePhaseSpace._ParticlePhaseSpace._Fill_Methods" title="Link to this definition"></a></dt>
<dd><p>Methods for calculating secondary quantities and adding them to ps_data</p>
<dl class="py method">
<dt class="sig sig-object py" id="ParticlePhaseSpace._ParticlePhaseSpace._Fill_Methods.beta_and_gamma">
<span class="sig-name descname"><span class="pre">beta_and_gamma</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#ParticlePhaseSpace._ParticlePhaseSpace._Fill_Methods.beta_and_gamma" title="Link to this definition"></a></dt>
<dd><p>add the relatavistic beta and gamma factors into self._PS._ps_data</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ParticlePhaseSpace._ParticlePhaseSpace._Fill_Methods.direction_cosines">
<span class="sig-name descname"><span class="pre">direction_cosines</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#ParticlePhaseSpace._ParticlePhaseSpace._Fill_Methods.direction_cosines" title="Link to this definition"></a></dt>
<dd><p>Calculate direction cosines, which are required for topas import:
U (direction cosine of momentum with respect to X)
V (direction cosine of momentum with respect to Y)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ParticlePhaseSpace._ParticlePhaseSpace._Fill_Methods.kinetic_E">
<span class="sig-name descname"><span class="pre">kinetic_E</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#ParticlePhaseSpace._ParticlePhaseSpace._Fill_Methods.kinetic_E" title="Link to this definition"></a></dt>
<dd><dl class="simple">
<dt>Uses <a class="reference external" href="https://en.wikipedia.org/wiki/Energy%E2%80%93momentum_relation">energy-momementum relation</a> to add</dt><dd><p>kinetic energy into self._ps_data</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ParticlePhaseSpace._ParticlePhaseSpace._Fill_Methods.relativistic_mass">
<span class="sig-name descname"><span class="pre">relativistic_mass</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#ParticlePhaseSpace._ParticlePhaseSpace._Fill_Methods.relativistic_mass" title="Link to this definition"></a></dt>
<dd><p>add relativistic mass to ps_data</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ParticlePhaseSpace._ParticlePhaseSpace._Fill_Methods.rest_mass">
<span class="sig-name descname"><span class="pre">rest_mass</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#ParticlePhaseSpace._ParticlePhaseSpace._Fill_Methods.rest_mass" title="Link to this definition"></a></dt>
<dd><p>add rest mass to self._PS._ps_data
:return:</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ParticlePhaseSpace._ParticlePhaseSpace._Fill_Methods.velocity">
<span class="sig-name descname"><span class="pre">velocity</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#ParticlePhaseSpace._ParticlePhaseSpace._Fill_Methods.velocity" title="Link to this definition"></a></dt>
<dd><p>add velocities in m/s into self._PS._ps_data</p>
</dd></dl>

</dd></dl>

</section>
<section id="phasespace-transform">
<h2>PhaseSpace.transform<a class="headerlink" href="#phasespace-transform" title="Link to this heading"></a></h2>
</section>
<section id="module-ParticlePhaseSpace.DataExporters">
<span id="data-exporters"></span><h2>Data Exporters<a class="headerlink" href="#module-ParticlePhaseSpace.DataExporters" title="Link to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="ParticlePhaseSpace.DataExporters.CSV_Exporter">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">ParticlePhaseSpace.DataExporters.</span></span><span class="sig-name descname"><span class="pre">CSV_Exporter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">PhaseSpaceInstance:</span> <span class="pre">~ParticlePhaseSpace._ParticlePhaseSpace.PhaseSpace</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_location:</span> <span class="pre">(&lt;class</span> <span class="pre">'str'&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">&lt;class</span> <span class="pre">'pathlib.Path'&gt;)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_name:</span> <span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ParticlePhaseSpace.DataExporters.CSV_Exporter" title="Link to this definition"></a></dt>
<dd><p>Export data to a csv format, in particular one which can be read by p2sat read text
# weight          x (um)          y (um)          z (um)          px (MeV/c)      py (MeV/c)      pz (MeV/c)      t (fs)</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="ParticlePhaseSpace.DataExporters.Topas_Exporter">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">ParticlePhaseSpace.DataExporters.</span></span><span class="sig-name descname"><span class="pre">Topas_Exporter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">PhaseSpaceInstance:</span> <span class="pre">~ParticlePhaseSpace._ParticlePhaseSpace.PhaseSpace</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_location:</span> <span class="pre">(&lt;class</span> <span class="pre">'str'&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">&lt;class</span> <span class="pre">'pathlib.Path'&gt;)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_name:</span> <span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">binary:</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ParticlePhaseSpace.DataExporters.Topas_Exporter" title="Link to this definition"></a></dt>
<dd><p>output the phase space to <a class="reference external" href="https://topas.readthedocs.io/en/latest/parameters/source/phasespace.html">topas ascii or binary format</a>.
the default output is ascii, the user can output binary by passing the flag <cite>binary</cite> as a boolean e.g. <cite>binary=True</cite></p>
<dl class="simple">
<dt>Note:</dt><dd><ul class="simple">
<li><p>we do not handle any time features</p></li>
<li><p>every particle in the phase space is flagged as being a new history.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="limitations.html" class="btn btn-neutral float-left" title="Limitations" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022, Brendan Whelan.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>