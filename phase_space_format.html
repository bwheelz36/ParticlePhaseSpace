<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Phase Space Format &mdash; Particle Phase Space  documentation</title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/sphinx_highlight.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Supported particles" href="supported_particles.html" />
    <link rel="prev" title="Working with different units" href="units.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            Particle Phase Space
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="examples.html">Examples</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Phase Space Format</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#required-columns">Required Columns</a></li>
<li class="toctree-l2"><a class="reference internal" href="#allowed-columns">Allowed Columns</a></li>
<li class="toctree-l2"><a class="reference internal" href="#units">Units</a></li>
<li class="toctree-l2"><a class="reference internal" href="#reading-in-momentum">Reading in momentum</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#if-energy-direction-cosines-are-specified">If energy/ direction cosines are specified:</a></li>
<li class="toctree-l3"><a class="reference internal" href="#if-beta-gamma-specified">If beta/ gamma specified</a></li>
<li class="toctree-l3"><a class="reference internal" href="#if-momentum-is-specified-in-si-units">If momentum is specified in SI units</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="supported_particles.html">Supported particles</a></li>
<li class="toctree-l1"><a class="reference internal" href="code_docs.html">Code Documentation</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Particle Phase Space</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Phase Space Format</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/phase_space_format.md.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  
<style>
/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<section id="phase-space-format">
<h1>Phase Space Format<a class="headerlink" href="#phase-space-format" title="Permalink to this heading"></a></h1>
<p>The allowed columns in the phase space data are defined in the <code class="docutils literal notranslate"><span class="pre">__phase_space_config.py</span></code> file, and are split into
two categories:</p>
<ol class="arabic simple">
<li><p><strong>Required columns</strong> are, as the name implies, required and present at all times. These are the core data used
to represent the phase space; all other data can be derived from these. Each DataLoader must fill in these and only these columns to generate a valid import object.</p></li>
<li><p><strong>Allowed columns</strong> can optionally be filled in using a <code class="docutils literal notranslate"><span class="pre">fill</span></code> method on a PhaseSpace object. For instance, to fill the allowed column <code class="docutils literal notranslate"><span class="pre">Ek</span> <span class="pre">[MeV]</span></code> you would use the <code class="docutils literal notranslate"><span class="pre">fill_kinetic_E</span></code> method. You are free to update the <code class="docutils literal notranslate"><span class="pre">allowed_columns</span></code> at any time, however in order for the code to pass testing you must:</p></li>
<li><p>Write an associated <code class="docutils literal notranslate"><span class="pre">fill</span></code> method</p></li>
<li><p>Update the test <code class="docutils literal notranslate"><span class="pre">test_all_allowed_columns_can_be_filled</span></code> inside <code class="docutils literal notranslate"><span class="pre">test_ParticlePhaseSpace</span></code></p></li>
<li><p>Update the “Allowed Columns” documentation below</p></li>
</ol>
<section id="required-columns">
<h2>Required Columns<a class="headerlink" href="#required-columns" title="Permalink to this heading"></a></h2>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Column name</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>x [units], y [units], z [units]</p></td>
<td><p>The position of each particle in mm</p></td>
</tr>
<tr class="row-odd"><td><p>px [units], py [units], pz [units]</p></td>
<td><p>the relativistic momentum of each particle in MeV/c</p></td>
</tr>
<tr class="row-even"><td><p>particle type [pdg_code]</p></td>
<td><p>The particle type, encoded as an integer <a class="reference external" href="https://pdg.lbl.gov/2012/mcdata/mc_particle_id_contents.html">pdg code</a></p></td>
</tr>
<tr class="row-odd"><td><p>weight</p></td>
<td><p>the statistical weight of each particle. This is used to calculate weighted statistics. In many cases this will be 1 for all particles</p></td>
</tr>
<tr class="row-even"><td><p>particle id</p></td>
<td><p>each particle in the phase space must have a unique integer particle ID</p></td>
</tr>
<tr class="row-odd"><td><p>time [units]</p></td>
<td><p>the time the particle was recorded (in many cases this will be 0 for all particles)</p></td>
</tr>
</tbody>
</table>
</section>
<section id="allowed-columns">
<h2>Allowed Columns<a class="headerlink" href="#allowed-columns" title="Permalink to this heading"></a></h2>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Column Name</p></th>
<th class="head"><p>Description</p></th>
<th class="head"><p>fill method</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Ek [units]</p></td>
<td><p>Kinetic energy</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">fill_kinetic_E</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>rest mass [units]</p></td>
<td><p>Particle rest mass</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">fill_rest_mass</span></code></p></td>
</tr>
<tr class="row-even"><td><p>p_abs</p></td>
<td><p>Total momentum</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">fill_absolute_momentum</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>relativistic mass [units]</p></td>
<td><p>Particle mass</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">fill_relativistic_mass</span></code></p></td>
</tr>
<tr class="row-even"><td><p>beta_x, beta_y, beta_z, beta_abs</p></td>
<td><p><a class="reference external" href="https://en.wikipedia.org/wiki/Lorentz_factor">x Beta factor</a> of particle</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">fill_beta_and_gamma</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>gamma</p></td>
<td><p><a class="reference external" href="https://en.wikipedia.org/wiki/Lorentz_factor">Lorentz factor</a> of particle</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">fill_beta_and_gamma</span></code></p></td>
</tr>
<tr class="row-even"><td><p>vx [units], vy [units], vz [units]</p></td>
<td><p>relativistic particle velocity in m/s</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">fill_velocity</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>Direction Cosine X, Direction Cosine Y, Direction Cosine Z</p></td>
<td><p><a class="reference external" href="https://en.wikipedia.org/wiki/Direction_cosine">Direction Cosines</a> of particle momentum</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">fill_direction_cosines</span></code></p></td>
</tr>
</tbody>
</table>
</section>
<section id="units">
<h2>Units<a class="headerlink" href="#units" title="Permalink to this heading"></a></h2>
<p>This code can work with several different unit sets, and new unit sets can also be easily defined. Rather than attempt to document these here, see the ‘living documentation’ in notebook format <a class="reference external" href="https://bwheelz36.github.io/ParticlePhaseSpace/units.html">here</a>. This example shows the different unit sets available, how to use them, and how to add new unit sets if none of the existing ones are what you want.</p>
</section>
<section id="reading-in-momentum">
<h2>Reading in momentum<a class="headerlink" href="#reading-in-momentum" title="Permalink to this heading"></a></h2>
<p>Position-Momentum are the fundamental quantities read in by the DataLoaders. Position is (hopefully) trivial,
but for momentum we make the following notes that may help in converting different properties into momentum:</p>
<section id="if-energy-direction-cosines-are-specified">
<h3>If energy/ direction cosines are specified:<a class="headerlink" href="#if-energy-direction-cosines-are-specified" title="Permalink to this heading"></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">math</span> <span class="kn">import</span> <span class="n">sqrt</span>
<span class="n">P</span> <span class="o">=</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">E</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">E_0</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
<p>where</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">E</span> <span class="o">=</span> <span class="n">E_k</span> <span class="o">+</span> <span class="n">E_0</span>
</pre></div>
</div>
<p>E should be in units of MeV.</p>
<p>To calculate px, py, and pz  from this, you must have something like the momentum cosines.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">p_x</span> <span class="o">=</span> <span class="n">P</span><span class="o">*</span><span class="n">DirectionCosine_x</span>
</pre></div>
</div>
<p>etc.</p>
</section>
<section id="if-beta-gamma-specified">
<h3>If beta/ gamma specified<a class="headerlink" href="#if-beta-gamma-specified" title="Permalink to this heading"></a></h3>
<p>For charged particles, data may be specified in terms of beta/gamma. In that case:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">P</span> <span class="o">=</span> <span class="n">beta</span><span class="o">*</span><span class="n">gamma</span><span class="o">*</span><span class="n">rest_energy</span>
<span class="n">p_x</span> <span class="o">=</span> <span class="n">beta_x</span><span class="o">*</span><span class="n">gamma</span><span class="o">*</span><span class="n">rest_energy</span>
</pre></div>
</div>
<p>etc.
rest_energy should be specified in MeV, e.g. for electrons the value is 0.511 MeV</p>
</section>
<section id="if-momentum-is-specified-in-si-units">
<h3>If momentum is specified in SI units<a class="headerlink" href="#if-momentum-is-specified-in-si-units" title="Permalink to this heading"></a></h3>
<p>We always use some form of <code class="docutils literal notranslate"><span class="pre">eV/c</span></code> for momentum. In the somewhat unusual situation that momentum is specified in the SI <code class="docutils literal notranslate"><span class="pre">kg.m/s</span></code> you can convert it as per below:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">P_ev_c</span> <span class="o">=</span> <span class="n">P_SI</span> <span class="o">*</span> <span class="p">(</span><span class="n">c</span><span class="o">/</span><span class="n">q</span><span class="p">)</span>
<span class="n">P_MeV_c</span> <span class="o">=</span> <span class="n">P_SI</span> <span class="o">*</span> <span class="p">(</span><span class="n">c</span><span class="o">/</span><span class="n">q</span><span class="p">)</span> <span class="o">*</span> <span class="mf">1e-6</span>
</pre></div>
</div>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="units.html" class="btn btn-neutral float-left" title="Working with different units" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="supported_particles.html" class="btn btn-neutral float-right" title="Supported particles" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022, Brendan Whelan.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>