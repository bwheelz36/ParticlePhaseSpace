<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Working with different units &mdash; Particle Phase Space  documentation</title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/sphinx_highlight.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
        <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Compress phase space via regrid/merge operations" href="grid_merge.html" />
    <link rel="prev" title="Writing a new data exporter" href="new_data_exporter.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            Particle Phase Space
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="examples.html">Examples</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="basic_example.html">Basic Example</a></li>
<li class="toctree-l2"><a class="reference internal" href="new_data_loader.html">Writing a new data loader</a></li>
<li class="toctree-l2"><a class="reference internal" href="new_data_exporter.html">Writing a new data exporter</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Working with different units</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#Available-units">Available units</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Setting-units-at-data-read-in">Setting units at data read in</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Changing-units-after-read-in">Changing units after read in</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Defining-new-unit-sets">Defining new unit sets</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="grid_merge.html">Compress phase space via regrid/merge operations</a></li>
<li class="toctree-l2"><a class="reference internal" href="resampling_via_gaussian_kde.html">Up/Down sampling phase space data using gaussian KDE</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="phase_space_format.html">Phase Space Format</a></li>
<li class="toctree-l1"><a class="reference internal" href="supported_particles.html">Supported particles</a></li>
<li class="toctree-l1"><a class="reference internal" href="code_docs.html">Code Documentation</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Particle Phase Space</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="examples.html">Examples</a></li>
      <li class="breadcrumb-item active">Working with different units</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/units.ipynb.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput.container div.prompt *,
div.nboutput.container div.prompt *,
div.nbinput.container div.input_area pre,
div.nboutput.container div.output_area pre,
div.nbinput.container div.input_area .highlight,
div.nboutput.container div.output_area .highlight {
    border: none;
    padding: 0;
    margin: 0;
    box-shadow: none;
}

div.nbinput.container > div[class*=highlight],
div.nboutput.container > div[class*=highlight] {
    margin: 0;
}

div.nbinput.container div.prompt *,
div.nboutput.container div.prompt * {
    background: none;
}

div.nboutput.container div.output_area .highlight,
div.nboutput.container div.output_area pre {
    background: unset;
}

div.nboutput.container div.output_area div.highlight {
    color: unset;  /* override Pygments text color */
}

/* avoid gaps between output lines */
div.nboutput.container div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput.container,
div.nboutput.container {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput.container,
    div.nboutput.container {
        flex-direction: column;
    }
}

/* input container */
div.nbinput.container {
    padding-top: 5px;
}

/* last container */
div.nblast.container {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput.container div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput.container div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput.container div.prompt,
div.nboutput.container div.prompt {
    width: 4.5ex;
    padding-top: 5px;
    position: relative;
    user-select: none;
}

div.nbinput.container div.prompt > div,
div.nboutput.container div.prompt > div {
    position: absolute;
    right: 0;
    margin-right: 0.3ex;
}

@media (max-width: 540px) {
    div.nbinput.container div.prompt,
    div.nboutput.container div.prompt {
        width: unset;
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput.container div.prompt.empty {
        padding: 0;
    }

    div.nbinput.container div.prompt > div,
    div.nboutput.container div.prompt > div {
        position: unset;
    }
}

/* disable scrollbars and line breaks on prompts */
div.nbinput.container div.prompt pre,
div.nboutput.container div.prompt pre {
    overflow: hidden;
    white-space: pre;
}

/* input/output area */
div.nbinput.container div.input_area,
div.nboutput.container div.output_area {
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput.container div.input_area,
    div.nboutput.container div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput.container div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    /*background: #f5f5f5;*/
}

/* override MathJax center alignment in output cells */
div.nboutput.container div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput.container div.math p {
    text-align: left;
}

/* standard error */
div.nboutput.container div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }


div.nbinput.container div.input_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight].math,
div.nboutput.container div.output_area.rendered_html,
div.nboutput.container div.output_area > div.output_javascript,
div.nboutput.container div.output_area:not(.rendered_html) > img{
    padding: 5px;
    margin: 0;
}

/* fix copybtn overflow problem in chromium (needed for 'sphinx_copybutton') */
div.nbinput.container div.input_area > div[class^='highlight'],
div.nboutput.container div.output_area > div[class^='highlight']{
    overflow-y: hidden;
}

/* hide copybtn icon on prompts (needed for 'sphinx_copybutton') */
.prompt .copybtn {
    display: none;
}

/* Some additional styling taken form the Jupyter notebook CSS */
.jp-RenderedHTMLCommon table,
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
.jp-RenderedHTMLCommon thead,
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
.jp-RenderedHTMLCommon tr,
.jp-RenderedHTMLCommon th,
.jp-RenderedHTMLCommon td,
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
.jp-RenderedHTMLCommon th,
div.rendered_html th {
  font-weight: bold;
}
.jp-RenderedHTMLCommon tbody tr:nth-child(odd),
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
.jp-RenderedHTMLCommon tbody tr:hover,
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}

/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<section id="Working-with-different-units">
<h1>Working with different units<a class="headerlink" href="#Working-with-different-units" title="Permalink to this heading"></a></h1>
<p>You can use a variety of different unit conventions in <code class="docutils literal notranslate"><span class="pre">ParticlePhaseSpace</span></code>. There are a number of unit sets pre programmed, and it’s also easy to create your own.</p>
<section id="Available-units">
<h2>Available units<a class="headerlink" href="#Available-units" title="Permalink to this heading"></a></h2>
<p>First let’s look at what units are currently available:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">from</span> <span class="nn">pathlib</span> <span class="kn">import</span> <span class="n">Path</span>
<span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;../&#39;</span><span class="p">)</span>  <span class="c1"># not necessary when the library is installed</span>
<span class="kn">from</span> <span class="nn">ParticlePhaseSpace</span> <span class="kn">import</span> <span class="n">ParticlePhaseSpaceUnits</span>
<span class="kn">from</span> <span class="nn">ParticlePhaseSpace</span> <span class="kn">import</span> <span class="n">DataLoaders</span>
<span class="kn">from</span> <span class="nn">ParticlePhaseSpace</span> <span class="kn">import</span> <span class="n">PhaseSpace</span>


<span class="n">available_units</span> <span class="o">=</span> <span class="n">ParticlePhaseSpaceUnits</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">available_units</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Available Unit Sets
=================
cm_MeV:
=================
Length: cm,
Energy: MeV,
Momentum: MeV/c
Velocity: m/s
Mass: MeV/c^2

=================
m_eV:
=================
Length: m,
Energy: eV,
Momentum: eV/c
Velocity: m/s
Mass: eV/c^2

=================
mm_MeV:
=================
Length: mm,
Energy: MeV,
Momentum: MeV/c
Velocity: m/s
Mass: MeV/c^2

=================
p2_sat_UHI:
=================
Length: um,
Energy: MeV,
Momentum: MeV/c
Velocity: m/s
Mass: MeV/c^2

=================
um_keV:
=================
Length: um,
Energy: keV,
Momentum: keV/c
Velocity: m/s
Mass: keV/c^2

</pre></div></div>
</div>
<p>From these available units sets, you can pick the one you want like this:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">my_units</span> <span class="o">=</span> <span class="n">available_units</span><span class="p">(</span><span class="s1">&#39;mm_MeV&#39;</span><span class="p">)</span>
<span class="n">my_units</span> <span class="o">=</span> <span class="n">available_units</span><span class="o">.</span><span class="n">mm_MeV</span>  <span class="c1"># equivalalent</span>
</pre></div>
</div>
</div>
<p>You can also easily define new units sets, but we will come to that later.</p>
</section>
<section id="Setting-units-at-data-read-in">
<h2>Setting units at data read in<a class="headerlink" href="#Setting-units-at-data-read-in" title="Permalink to this heading"></a></h2>
<p>By default, <code class="docutils literal notranslate"><span class="pre">DataLoaders</span></code> use <code class="docutils literal notranslate"><span class="pre">mm_MeV</span></code> as the unit set. If you are reading in data with different untis, you just have to pass a unit set:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">different_units</span> <span class="o">=</span> <span class="n">available_units</span><span class="p">(</span><span class="s1">&#39;um_keV&#39;</span><span class="p">)</span>
<span class="n">test_data_loc</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;../tests/test_data/coll_PhaseSpace_xAng_0.00_yAng_0.00_angular_error_0.0.phsp&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">absolute</span><span class="p">()</span>
<span class="n">ps_data</span> <span class="o">=</span> <span class="n">DataLoaders</span><span class="o">.</span><span class="n">Load_TopasData</span><span class="p">(</span><span class="n">test_data_loc</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="n">different_units</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ps_data</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>particle type [pdg_code]</th>
      <th>x [um]</th>
      <th>y [um]</th>
      <th>z [um]</th>
      <th>weight</th>
      <th>particle id</th>
      <th>time [ps]</th>
      <th>px [keV/c]</th>
      <th>py [keV/c]</th>
      <th>pz [keV/c]</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>22</td>
      <td>-0.971177</td>
      <td>-0.817280</td>
      <td>396.0</td>
      <td>0.01</td>
      <td>0</td>
      <td>0</td>
      <td>-0.008856</td>
      <td>-0.010509</td>
      <td>-3.184060</td>
    </tr>
    <tr>
      <th>1</th>
      <td>22</td>
      <td>-0.916198</td>
      <td>0.839298</td>
      <td>396.0</td>
      <td>0.01</td>
      <td>1</td>
      <td>0</td>
      <td>-0.003894</td>
      <td>0.008249</td>
      <td>-1.560114</td>
    </tr>
    <tr>
      <th>2</th>
      <td>22</td>
      <td>-5.258902</td>
      <td>11.318420</td>
      <td>396.0</td>
      <td>0.01</td>
      <td>2</td>
      <td>0</td>
      <td>-0.193061</td>
      <td>0.377104</td>
      <td>-1.219742</td>
    </tr>
    <tr>
      <th>3</th>
      <td>22</td>
      <td>15.326971</td>
      <td>-25.628899</td>
      <td>396.0</td>
      <td>0.01</td>
      <td>3</td>
      <td>0</td>
      <td>0.102889</td>
      <td>-0.362594</td>
      <td>-1.414843</td>
    </tr>
    <tr>
      <th>4</th>
      <td>22</td>
      <td>-0.241948</td>
      <td>-0.401026</td>
      <td>396.0</td>
      <td>0.01</td>
      <td>4</td>
      <td>0</td>
      <td>-0.000192</td>
      <td>-0.001470</td>
      <td>-0.209232</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>Note that this step does not convert any of the numbers in the data; it simply defines what units these numbers represent. When we pass the <code class="docutils literal notranslate"><span class="pre">DataLoader</span></code> to <code class="docutils literal notranslate"><span class="pre">PhaseSpace</span></code>, the units are preserved:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">PS</span> <span class="o">=</span> <span class="n">PhaseSpace</span><span class="p">(</span><span class="n">ps_data</span><span class="p">)</span>
<span class="n">PS</span><span class="o">.</span><span class="n">get_units</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
um_keV:
=================
Length: um,
Energy: keV,
Momentum: keV/c
Velocity: m/s
Mass: keV/c^2
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">PS</span><span class="o">.</span><span class="n">ps_data</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>particle type [pdg_code]</th>
      <th>x [um]</th>
      <th>y [um]</th>
      <th>z [um]</th>
      <th>weight</th>
      <th>particle id</th>
      <th>time [ps]</th>
      <th>px [keV/c]</th>
      <th>py [keV/c]</th>
      <th>pz [keV/c]</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>22</td>
      <td>-0.971177</td>
      <td>-0.817280</td>
      <td>396.0</td>
      <td>0.01</td>
      <td>0</td>
      <td>0</td>
      <td>-0.008856</td>
      <td>-0.010509</td>
      <td>-3.184060</td>
    </tr>
    <tr>
      <th>1</th>
      <td>22</td>
      <td>-0.916198</td>
      <td>0.839298</td>
      <td>396.0</td>
      <td>0.01</td>
      <td>1</td>
      <td>0</td>
      <td>-0.003894</td>
      <td>0.008249</td>
      <td>-1.560114</td>
    </tr>
    <tr>
      <th>2</th>
      <td>22</td>
      <td>-5.258902</td>
      <td>11.318420</td>
      <td>396.0</td>
      <td>0.01</td>
      <td>2</td>
      <td>0</td>
      <td>-0.193061</td>
      <td>0.377104</td>
      <td>-1.219742</td>
    </tr>
    <tr>
      <th>3</th>
      <td>22</td>
      <td>15.326971</td>
      <td>-25.628899</td>
      <td>396.0</td>
      <td>0.01</td>
      <td>3</td>
      <td>0</td>
      <td>0.102889</td>
      <td>-0.362594</td>
      <td>-1.414843</td>
    </tr>
    <tr>
      <th>4</th>
      <td>22</td>
      <td>-0.241948</td>
      <td>-0.401026</td>
      <td>396.0</td>
      <td>0.01</td>
      <td>4</td>
      <td>0</td>
      <td>-0.000192</td>
      <td>-0.001470</td>
      <td>-0.209232</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
</section>
<section id="Changing-units-after-read-in">
<h2>Changing units after read in<a class="headerlink" href="#Changing-units-after-read-in" title="Permalink to this heading"></a></h2>
<p>Let’read in the data again, this time with the correct unit set (<code class="docutils literal notranslate"><span class="pre">mm_MeV</span></code>):</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ps_data</span> <span class="o">=</span> <span class="n">DataLoaders</span><span class="o">.</span><span class="n">Load_TopasData</span><span class="p">(</span><span class="n">test_data_loc</span><span class="p">)</span>
<span class="n">PS</span> <span class="o">=</span> <span class="n">PhaseSpace</span><span class="p">(</span><span class="n">ps_data</span><span class="p">)</span>
<span class="n">PS</span><span class="o">.</span><span class="n">get_units</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
mm_MeV:
=================
Length: mm,
Energy: MeV,
Momentum: MeV/c
Velocity: m/s
Mass: MeV/c^2
</pre></div></div>
</div>
<p>We can now change the units using the <code class="docutils literal notranslate"><span class="pre">set_units</span></code> method:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">PS</span><span class="o">.</span><span class="n">set_units</span><span class="p">(</span><span class="n">different_units</span><span class="p">)</span>
<span class="n">PS</span><span class="o">.</span><span class="n">get_units</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
um_keV:
=================
Length: um,
Energy: keV,
Momentum: keV/c
Velocity: m/s
Mass: keV/c^2
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">PS</span><span class="o">.</span><span class="n">ps_data</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>particle type [pdg_code]</th>
      <th>x [um]</th>
      <th>y [um]</th>
      <th>z [um]</th>
      <th>weight</th>
      <th>particle id</th>
      <th>time [ps]</th>
      <th>px [keV/c]</th>
      <th>py [keV/c]</th>
      <th>pz [keV/c]</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>22</td>
      <td>-971.176758</td>
      <td>-817.280090</td>
      <td>396000.0</td>
      <td>0.01</td>
      <td>0</td>
      <td>0.0</td>
      <td>-8.855738</td>
      <td>-10.508804</td>
      <td>-3184.060481</td>
    </tr>
    <tr>
      <th>1</th>
      <td>22</td>
      <td>-916.197754</td>
      <td>839.297668</td>
      <td>396000.0</td>
      <td>0.01</td>
      <td>1</td>
      <td>0.0</td>
      <td>-3.894435</td>
      <td>8.249210</td>
      <td>-1560.114059</td>
    </tr>
    <tr>
      <th>2</th>
      <td>22</td>
      <td>-5258.901367</td>
      <td>11318.419922</td>
      <td>396000.0</td>
      <td>0.01</td>
      <td>2</td>
      <td>0.0</td>
      <td>-193.061367</td>
      <td>377.103855</td>
      <td>-1219.741850</td>
    </tr>
    <tr>
      <th>3</th>
      <td>22</td>
      <td>15326.970703</td>
      <td>-25628.898438</td>
      <td>396000.0</td>
      <td>0.01</td>
      <td>3</td>
      <td>0.0</td>
      <td>102.888760</td>
      <td>-362.594239</td>
      <td>-1414.843426</td>
    </tr>
    <tr>
      <th>4</th>
      <td>22</td>
      <td>-241.947769</td>
      <td>-401.025604</td>
      <td>396000.0</td>
      <td>0.01</td>
      <td>4</td>
      <td>0.0</td>
      <td>-0.191501</td>
      <td>-1.469658</td>
      <td>-209.231939</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>Note that this time, the actual values in the data <strong>have</strong> changed. Also note that all labels in graphs are automaticall updated, e.g.:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">PS</span><span class="o">.</span><span class="n">plot_energy_hist_1D</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/units_16_0.png" src="_images/units_16_0.png" />
</div>
</div>
<p>Whenever you use the <code class="docutils literal notranslate"><span class="pre">set_units</span></code> method, the data will be reset using the <code class="docutils literal notranslate"><span class="pre">reset_phase_space</span></code> method. This means the data is reduced to only the <a class="reference external" href="https://bwheelz36.github.io/ParticlePhaseSpace/phase_space_format.html">required columns</a>, so that any other quantities must be recalculated following a unit change</p>
</section>
<section id="Defining-new-unit-sets">
<h2>Defining new unit sets<a class="headerlink" href="#Defining-new-unit-sets" title="Permalink to this heading"></a></h2>
<p>If the unit set you want to work with is not already listed in the <code class="docutils literal notranslate"><span class="pre">available_units</span></code> above, you can easily create new unit sets. The <strong>highly</strong> advised way to do this is to add your new unit set to the <code class="docutils literal notranslate"><span class="pre">__init__</span></code> method of <code class="docutils literal notranslate"><span class="pre">ParticlePhaseSpace.__unit_config__.ParticlePhaseSpaceUnits</span></code> by copying then updating the definition of the existing unit_sets. This is because unit sets defined in this way are subject to automatic testing to ensure for instance consistency between dimensionless
quantities. However, if you really want you can also do it manually as below. Note that this is not the preferred method but it will work!</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">ParticlePhaseSpace.__unit_config__</span> <span class="kn">import</span> <span class="n">UnitSet</span><span class="p">,</span> <span class="n">_unit</span>
<span class="n">cm_keV</span> <span class="o">=</span> <span class="n">UnitSet</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;cm_keV&#39;</span><span class="p">,</span>
                              <span class="n">length_units</span><span class="o">=</span><span class="n">_unit</span><span class="p">(</span><span class="s1">&#39;cm&#39;</span><span class="p">,</span> <span class="mf">1e-1</span><span class="p">),</span>
                              <span class="n">energy_units</span><span class="o">=</span><span class="n">_unit</span><span class="p">(</span><span class="s1">&#39;keV&#39;</span><span class="p">,</span> <span class="mf">1e3</span><span class="p">),</span>
                              <span class="n">momentum_units</span><span class="o">=</span><span class="n">_unit</span><span class="p">(</span><span class="s1">&#39;keV/c&#39;</span><span class="p">,</span> <span class="mf">1e3</span><span class="p">),</span>
                              <span class="n">time_units</span><span class="o">=</span><span class="n">_unit</span><span class="p">(</span><span class="s1">&#39;ns&#39;</span><span class="p">,</span> <span class="mf">1e-3</span><span class="p">),</span>
                              <span class="n">mass_units</span><span class="o">=</span><span class="n">_unit</span><span class="p">(</span><span class="s1">&#39;keV/c^2&#39;</span><span class="p">,</span> <span class="mf">1e3</span><span class="p">),</span>
                              <span class="n">velocity_units</span><span class="o">=</span><span class="n">_unit</span><span class="p">(</span><span class="s1">&#39;kmph&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="mf">3.6</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">cm_keV</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
cm_keV:
=================
Length: cm,
Energy: keV,
Momentum: keV/c
Velocity: kmph
Mass: keV/c^2
</pre></div></div>
</div>
<ul class="simple">
<li><p>In a <code class="docutils literal notranslate"><span class="pre">UnitSet</span></code>, the <code class="docutils literal notranslate"><span class="pre">label</span></code> tag is the name of the UnitSet and is mainly used internally to compare unit sets.</p></li>
<li><p>every other quantity is a <code class="docutils literal notranslate"><span class="pre">_unit</span></code> - each <code class="docutils literal notranslate"><span class="pre">_unit</span></code> comprises a label and a conversion factor. the label is self explanatory. THe conversion factor is the converion which would be needed to convert that quantity to the default unit set of <code class="docutils literal notranslate"><span class="pre">mm_MeV</span></code>. For example, the cm to mm conversion is defined as:</p></li>
</ul>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">value_in_mm</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">value_in_cm</span> <span class="o">=</span> <span class="mf">.1</span>
<span class="n">cm_conversion</span> <span class="o">=</span> <span class="n">value_in_cm</span><span class="o">/</span><span class="n">value_in_mm</span>
</pre></div>
</div>
</div>
<blockquote>
<div><p>Be very careful about defining unit sets that don’t match the conventions of the existing unit sets. The units will defintely work as long as you are changing the <strong>value</strong> of a given unit type, but not if you completely change the type of unit. E.g., defining mass in kg instead of some form of eV/c^2 will not work without substantialy edits to the code.</p>
</div></blockquote>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
</div>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="new_data_exporter.html" class="btn btn-neutral float-left" title="Writing a new data exporter" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="grid_merge.html" class="btn btn-neutral float-right" title="Compress phase space via regrid/merge operations" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022, Brendan Whelan.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>